---
title: API Key 安全性配置
order: 4
toc: content
---

# 👷 API Key 安全性配置
用户可以基于 API Key 连接私钥进行双重校验、合约地址白名单、访问来源白名单、API请求方法限制、以及对该API能够消耗的Credit最大用量进行合理限制。

## 概述
第一要素，保障安全！
通过本章节的学习，您可以进行以下一些安全性的配置：
- **密钥双重校验**
  启用双重密钥，保障访问的安全。
- **白名单控制**
  - 合约地址白名单：限定可以访问的合约地址，防止滥用。
  - 访问来源白名单：指定可发起访问的IP地址。
- **Credit用量控制**
  - 细颗粒度限制API Key可调用方法的范围。
  - 设定API Key的Credit用量上限。

## 设置路径
鼠标悬浮在已创建的目标 API Key 面板后，点击 **Action** ，在 API Key 管理页的 **Security** 功能页签下，可以设置 API Key 连接的安全性。
![security-config.png](./images/security-config.png)

API Key 连接的安全性，可以通过以下几个方面进行设置：
- [密钥双重校验](#密钥双重校验)
- [设置合约白名单](#设置合约白名单)
- [设置访问来源白名单](#设置访问来源白名单)
- [API请求方法限制](#api请求方法限制)
- [设置API消耗上限](#设置api消耗上限)

## 密钥双重校验
系统默认已为用户生成了 API Key 的双重密钥，启用双重密钥，可以保障访问的安全性。
- 选择开启
  在关闭状态下，点击 **Secret** 右侧的开关，经二次确认后可以开启 API Key 的双重验证。开启后，所有请求都需要通过密钥进行二次校验，校验成功后才能允许访问。
- 选择关闭
  在开启状态下，点击 **Secret** 右侧的开关，经二次确认后可以关闭 API Key 的双重验证。关闭后，所有请求则无需通过该密钥进行二次校验。

## 设置合约白名单
通过设置合约白名单，来限定可以访问的合约地址，防止 API Key 的滥用。
如果您的应用程序仅用于查询来自特定以太坊智能合约或地址的数据，请将这些地址添加到合约地址允许列表中。
任何查询不在允许列表中的地址的请求都将被拒绝。
以下这些RPC方法可以受用与这个功能：
- eth_call
- eth_estimateGas
- eth_getLogs
- eth_getBalance
- eth_getCode
- eth_getStorageAt
- eth_getTransactionCount

在 **Allowlists** 模块下，通过在 **Contract Addresses** 中添加合约地址来设置合约白名单。
- 如未在白名单中添加任何地址，则默认为未开启合约白名单，所有合约均可以访问。
- 如需要在白名单中添加合约地址，则只有录入到白名单中的合约地址才可以通过API进行调用。
  点击编辑小图标，可以录入多个合约地址，完成后点击 **Save** ，即可完成录入。
  点击编辑小图标，也可以删除当前已添加的合约地址，完成后点击 **Save** ，即可完成修改。

## 设置访问来源白名单
通过设置访问来源白名单，来指定可发起访问的IP地址。
在 **Allowlists** 模块下，通过在 **Source IP** 中添加IP地址来设置访问来源白名单。
- 如未在白名单中添加任何IP地址，则默认为未开启白名单访问限制，所有IP地址均可以访问。
- 如需要在白名单中添加IP地址，则只有录入到白名单中的IP地址发起请求时不会被拒绝。
  点击编辑小图标，可以录入多个IP地址，完成后点击 **Save** ，即可完成录入。
  点击编辑小图标，也可以删除当前已添加的IP地址，完成后点击 **Save** ，即可完成修改。

## API请求方法限制
通过设置API方法白名单，实现细颗粒度限制当前API Key可调用方法的范围。
在 **Allowlists** 模块下，通过在 **API Request Methods** 中添加当前 API 的具体方法来设置 API 方法白名单。
- 如未在白名单中添加任何 API 的具体方法，则默认未开启API 方法白名单，所有API 方法均可以调用。
- 如需要在白名单中添加具体的 API 方法，则设定后该API Key仅能访问白名单中的具体方法。
  点击编辑小图标，可以录入多个 API 方法，完成后点击 **Save** ，即可完成录入。
  点击编辑小图标，也可以删除当前已添加的 API 方法，完成后点击 **Save** ，即可完成修改。

## 设置API消耗上限
通过设定API Key的Credit用量上限，实现对Credit的用量控制。
在 **Allowlists** 模块下，通过在 **Request Cost Limit** 中填写当前 API 消耗 Credit 的最大用量（单位million）来设置当前 API 的消耗上限。
- 如不设置当前 API 消耗 Credit 的最大用量，则不会因为 Credit 的消耗量过大而拒绝该 API 的请求。
- 如需要设置当前 API 消耗 Credit 的最大用量，则设置成功后，当API 的请求所消耗 Credit 达到设定的上限时，该API的请求将会被拒绝。
  点击编辑小图标，可以设置一个API消耗上限值，完成后点击 **Save** ，即可完成设置。
  点击编辑小图标，也可以修改当前API消耗上限值，完成后点击 **Save** ，即可完成修改。